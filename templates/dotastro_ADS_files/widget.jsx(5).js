define(["underscore","backbone","react","react-dom","react-redux","analytics","js/components/api_query","js/components/api_request","js/components/api_targets","js/widgets/base/base_widget","./redux/configure-store","./redux/modules/api","./redux/modules/ui","./containers/app"],function(e,t,r,s,i,n,a,o,c,d,u,p,b,h){var l=t.View.extend({initialize:function(t){e.assign(this,t)},render:function(){return s.render(r.createElement(i.Provider,{store:this.store},r.createElement(h,null)),this.el),this},destroy:function(){s.unmountComponentAtNode(this.el)}});return d.extend({initialize:function(){this.store=u(this),this.view=new l({store:this.store}),window.__BUMBLEBEE_TESTING_MODE__||(this.processAbstractData=e.debounce(e.bind(this.processAbstractData,this),300))},defaultQueryArguments:{},activate:function(t){var r=this,s=this.store.dispatch;this.setBeeHive(t),this.activateWidget(),this.attachGeneralHandler(this.onApiFeedback);var i=this.getPubSub();i.subscribe(i.CUSTOM_EVENT,function(e,t){if("latest-abstract-data"===e){var i=r.store.getState().api.bibcode,n=t.bibcode||t.identifier;if(!(n=Array.isArray(n)?n[0]:n)||i===n)return;s(b.reset()),s(p.setBibcode(n)),r.processAbstractData(t)}}),i.subscribe(i.DELIVERING_RESPONSE,function(t){t&&e.isFunction(t.toJSON)?s(p.processResponse(t.toJSON())):s(b.setError("did not receive response from server"))})},processAbstractData:function(e){var t=this.store.dispatch;e&&e.property&&e.property.includes("ASSOCIATED")?this.dispatchRequest(new a):t(b.setError("no associated property"))},composeRequest:function(){var e=this.store.getState().api.bibcode;return new o({target:"".concat(c.RESOLVER,"/").concat(e,"/associated"),query:new a})},emitAnalytics:function(e){n("send","event","interaction","associated-link-followed",{target:"associated",url:e.rawUrl})},onApiFeedback:function(t){var r=this.store.dispatch;e.isPlainObject(t.error)&&(r(b.setError(t.error)),r(p.fallbackOnError()))}})});