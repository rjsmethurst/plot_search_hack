function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var o,r=_getPrototypeOf(t);if(e){var n=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}define(["underscore","react","react-redux","prop-types","../actions/index","../components/Closer.jsx","../components/Setup.jsx","../components/Export.jsx"],function(t,e,o,r,n,s,i,a){var l=n.closeComponent,c=n.setFormat,u=n.getNextBatch,m=n.fetchUsingQuery,p=n.fetchUsingIds,h=n.setCount,f=n.cancelRequest,d=n.reset,y=n.downloadFile,C=(n.getCustomFormats,function(o){_inherits(n,e.Component);var r=_createSuper(n);function n(e){var o;_classCallCheck(this,n),o=r.call(this,e),t.bindAll(_assertThisInitialized(o),["handleCloseClick","handleApplyClick","handleFormatChange","handleCountChange","handleCancelClick","handleGetNextClick","handleResetClick","handleDownloadFileClick","onCopyText","onCustomFormatClick"]);var s=e.dispatch;return o.updateCount=t.debounce(function(t){s(h(parseInt(t)))},500),o.onCustomFormatChange=t.debounce(function(t){s({type:"SET_CUSTOM_FORMAT",format:t})},500),o.state={count:"0",showAlert:!1,customFormatDirectEntry:!0},o}return _createClass(n,[{key:"handleDownloadFileClick",value:function(){this.props.dispatch(y())}},{key:"onCopyText",value:function(){var e=this;this.setState({showAlert:!0,alertMsg:"Text Copied!"}),t.delay(function(){return e.setState({showAlert:!1})},5e3)}},{key:"handleCloseClick",value:function(){this.props.dispatch(l())}},{key:"handleCancelClick",value:function(){this.props.dispatch(f())}},{key:"handleCountChange",value:function(t){var e=this;this.setState({count:t},function(){return e.updateCount(t)})}},{key:"handleApplyClick",value:function(){var e=this.props,o=e.dispatch,r=e.ids,n=e.query;t.isEmpty(n)&&!t.isEmpty(r)?o(p()):o(m()).done(function(){return o(p())})}},{key:"handleResetClick",value:function(){this.props.dispatch(d())}},{key:"onCustomFormatClick",value:function(){this.state.customFormatDirectEntry&&this.props.customFormats.length>0&&this.onCustomFormatChange(this.props.customFormats[0].code),this.setState({customFormatDirectEntry:!this.state.customFormatDirectEntry})}},{key:"handleFormatChange",value:function(e){var o=this.props,r=o.dispatch,n=o.formats,s=o.autoSubmit,i=t.find(n,{id:e});"custom"===i.value&&this.props.customFormats.length>0&&this.onCustomFormatChange(this.props.customFormats[0].code),r(c(i)),s&&"custom"!==i.value&&this.handleApplyClick()}},{key:"handleGetNextClick",value:function(){(0,this.props.dispatch)(u())}},{key:"componentWillReceiveProps",value:function(t){var e=t.totalRecs-t.maxCount;this.setState({count:""+t.count,hasMore:e>0,remaining:e>t.batchSize?t.batchSize:e})}},{key:"render",value:function(){var t=this.props,o=t.format,r=t.formats,n=t.isFetching,l=t.output,c=t.batchSize,u=t.showCloser,m=t.showReset,p=t.progress,h=t.maxCount,f=t.hasError,d=t.errorMsg,y=t.totalRecs,C=t.showSlider,b=t.splitCols,g=t.autoSubmit,v=t.customFormat,R=t.customFormats,_=this.state,F=_.count,k=_.hasMore,w=_.showAlert,E=_.alertMsg,S=_.remaining,x=_.customFormatDirectEntry,P=h-c,O=0===P?1:P,q=Number(F)+P,N=y>1&&C;return e.createElement("div",{className:"container-fluid export-container"},e.createElement("span",null,u&&e.createElement(s,{onClick:this.handleCloseClick}),e.createElement("div",{className:"h4"},"Exporting record(s) ",e.createElement("strong",null,O)," to"," ",e.createElement("strong",null,q)," ",e.createElement("small",null,"(total: ",y,")"))),e.createElement("div",null,e.createElement("div",{className:b?"col-sm-6":"col-sm-12"},e.createElement(i,{format:o,formats:r,disabled:n,count:F,maxCount:h,totalRecs:y,batchSize:c,hasMore:k,showSlider:N,showReset:m,autoSubmit:g,remaining:S,customFormat:v,customFormats:R,customFormatDirectEntry:x,onCustomFormatChange:this.onCustomFormatChange,onReset:this.handleResetClick,onApply:this.handleApplyClick,onCancel:this.handleCancelClick,setFormat:this.handleFormatChange,onGetNext:this.handleGetNextClick,setCount:this.handleCountChange,onCustomFormatClick:this.onCustomFormatClick}),f&&e.createElement("div",{className:"row"},e.createElement("div",{className:"col-sm-10"},e.createElement("div",{className:"alert alert-danger"},d))),w&&e.createElement("div",{className:"row"},e.createElement("div",{className:"col-sm-10"},e.createElement("div",{className:"alert alert-info"},E)))),e.createElement("div",{className:b?"col-sm-6":"col-sm-12"},e.createElement(a,{output:l,isFetching:n,progress:p,onDownloadFile:this.handleDownloadFileClick,onCopy:this.onCopyText}))))}}]),n}());C.propTypes={dispatch:r.func.isRequired,format:r.shape({id:r.string,value:r.string,label:r.string}).isRequired,formats:r.arrayOf(r.shape({id:r.string,value:r.string,label:r.string})).isRequired,isFetching:r.bool.isRequired,output:r.string.isRequired,progress:r.number.isRequired,count:r.number.isRequired,maxCount:r.number.isRequired,hasError:r.bool.isRequired,errorMsg:r.string.isRequired,batchSize:r.number.isRequired,totalRecs:r.number.isRequired,showCloser:r.bool.isRequired,showSlider:r.bool.isRequired,splitCols:r.bool.isRequired,showReset:r.bool.isRequired,autoSubmit:r.bool.isRequired};return o.connect(function(t){return{format:t.format,formats:t.formats,output:t.exports.output,isFetching:t.exports.isFetching,progress:t.exports.progress,count:t.exports.count,maxCount:t.exports.maxCount,hasError:t.error.hasError,errorMsg:t.error.errorMsg,batchSize:t.exports.batchSize,totalRecs:t.exports.totalRecs,customFormat:t.exports.customFormat,showCloser:t.main.showCloser,showSlider:t.main.showSlider,autoSubmit:t.main.autoSubmit,splitCols:t.main.splitCols,showReset:t.main.showReset,ids:t.exports.ids,query:t.main.query,customFormats:t.exports.customFormats}})(C)});